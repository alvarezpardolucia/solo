<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pieza de Danza - Institut del Teatre</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #6a0dad;
      --primary-light: #8a2be2;
      --white: #ffffff;
      --light-gray: #f8f9fa;
      --text-dark: #333333;
      --text-light: #666666;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background-color: var(--white);
      color: var(--text-dark);
      padding: 20px;
      text-align: center;
      line-height: 1.6;
    }
    
    .container {
      max-width: 700px;
      width: 100%;
      padding: 40px 20px;
    }
    
    header {
      margin-bottom: 60px;
    }
    
    h1 {
      font-weight: 400;
      font-size: 2.2rem;
      margin-bottom: 8px;
      color: var(--text-dark);
      letter-spacing: -0.5px;
    }
    
    .subtitle {
      font-weight: 300;
      font-size: 1.1rem;
      color: var(--text-light);
      margin-bottom: 4px;
    }
    
    .author {
      font-weight: 300;
      font-size: 0.95rem;
      color: var(--primary);
    }
    
    .phrase-container {
      min-height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 60px 0;
      padding: 40px 30px;
      position: relative;
    }
    
    #frase {
      font-size: 1.8rem;
      font-weight: 300;
      line-height: 1.6;
      color: var(--text-dark);
      transition: opacity 0.8s ease;
      max-width: 90%;
    }
    
    button {
      padding: 14px 50px;
      font-size: 1rem;
      font-weight: 400;
      cursor: pointer;
      background-color: var(--white);
      color: var(--primary);
      border: 1px solid var(--primary);
      border-radius: 0;
      transition: all 0.3s ease;
      margin-top: 20px;
      letter-spacing: 0.5px;
    }
    
    button:hover {
      background-color: var(--primary);
      color: var(--white);
    }
    
    button:active {
      transform: scale(0.98);
    }
    
    button:disabled {
      background-color: var(--white);
      color: var(--text-light);
      border-color: var(--text-light);
      cursor: not-allowed;
      transform: none;
    }
    
    .instructions {
      margin-top: 60px;
      padding-top: 20px;
      border-top: 1px solid #eee;
      font-size: 0.9rem;
      color: var(--text-light);
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .footer {
      margin-top: 60px;
      font-size: 0.8rem;
      color: var(--text-light);
    }
    
    /* Animaciones para las frases */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .fade-in {
      animation: fadeIn 1.2s ease forwards;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .container {
        padding: 30px 15px;
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      #frase {
        font-size: 1.5rem;
      }
      
      .phrase-container {
        min-height: 180px;
        margin: 50px 0;
        padding: 30px 20px;
      }
    }
    
    @media (max-width: 480px) {
      body {
        padding: 15px;
      }
      
      .container {
        padding: 20px 10px;
      }
      
      h1 {
        font-size: 1.6rem;
      }
      
      #frase {
        font-size: 1.3rem;
      }
      
      .phrase-container {
        min-height: 160px;
        margin: 40px 0;
        padding: 25px 15px;
      }
      
      button {
        padding: 12px 40px;
        font-size: 0.95rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Pieza de Danza</h1>
      <div class="subtitle">Institut del Teatre</div>
      <div class="author">Lucía Alvarez Pardo</div>
    </header>
    
    <div class="phrase-container">
      <div id="frase">Esperando para comenzar...</div>
    </div>
    
    <button id="startBtn">Iniciar Experiencia</button>
    
    <div class="instructions">
      Por favor, pulsa "Iniciar Experiencia" cuando comience la pieza y se te indique.
    </div>
  </div>
  
  <div class="footer">
    Diseñado para la pieza de danza del Institut del Teatre
  </div>

  <script>
    // === AUDIO ENGINE ===
    let audioCtx;
    function ensureAudioCtx() {
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      if (audioCtx.state === 'suspended') audioCtx.resume();
    }

    function playTone(freq = 880, duration = 200, wave = 'sine', volume = 0.06) {
      ensureAudioCtx();
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.type = wave;                 // 'sine' | 'square' | 'triangle' | 'sawtooth'
      osc.frequency.value = freq;

      const now = audioCtx.currentTime;
      const attack = 0.01, release = 0.05;
      gain.gain.setValueAtTime(0, now);
      gain.gain.linearRampToValueAtTime(volume, now + attack);
      gain.gain.setValueAtTime(volume, now + duration/1000 - release);
      gain.gain.linearRampToValueAtTime(0, now + duration/1000);

      osc.connect(gain).connect(audioCtx.destination);
      osc.start(now);
      osc.stop(now + duration/1000);
    }

    function playNoise(duration = 200, volume = 0.05) {
      ensureAudioCtx();
      const bufferSize = Math.floor(audioCtx.sampleRate * (duration / 1000));
      const buffer = audioCtx.createBuffer(2, bufferSize, audioCtx.sampleRate);
      for (let ch = 0; ch < 2; ch++) {
        const data = buffer.getChannelData(ch);
        for (let i = 0; i < bufferSize; i++) {
          data[i] = Math.random() * 2 - 1; // ruido blanco
        }
      }
      const src = audioCtx.createBufferSource();
      src.buffer = buffer;

      const gain = audioCtx.createGain();
      const now = audioCtx.currentTime;
      const attack = 0.005, release = 0.06;
      gain.gain.setValueAtTime(0, now);
      gain.gain.linearRampToValueAtTime(volume, now + attack);
      gain.gain.setValueAtTime(volume, now + duration/1000 - release);
      gain.gain.linearRampToValueAtTime(0, now + duration/1000);

      src.connect(gain).connect(audioCtx.destination);
      src.start(now);
      src.stop(now + duration/1000);
    }

    // === DATOS (corregido tiempo 95: una sola cadena en type) ===
    const frases = [
      { tiempo: 1, texto: "Cuando suene este sonido, haz lo que diga la frase que comienza a aparecer",  sound:  { type: 'square', freq: 300, duration: 300 }  },
      { tiempo: 3, texto: "Pero, cuando el tiempo separa las vidas", sound: { type: 'beep', freq: 784, duration: 180 }},
      { tiempo: 8, texto: "Mantente firme", sound: { type: 'beep', freq: 400, duration: 180 } },
      { tiempo: 15, texto: "Cuando todo es fluido, nada puede saberse con certeza"},
      { tiempo: 22, texto: "Mantente firme", sound: { type: 'beep', freq: 400, duration: 180 } },
      { tiempo: 30, texto: "Sosténlo hasta que lo sientas allí"},
      { tiempo: 38, texto: "Tan oscuro, denso y húmedo como la tierra"},
      { tiempo: 46, texto: "Tan vasto, brillante y dulce como el aire"},
      { tiempo: 55, texto: "Cuando lo único que hay es saber que sientes lo que estás sintiendo"},
      { tiempo: 64, texto: "Mantente firme", sound: { type: 'beep', freq: 400, duration: 180 }  },
      { tiempo: 70, texto: "Pide a tus manos que conozcan las cosas que sostienen"},
      { tiempo: 75, texto: "Lo sé, los días pasan tambaleándose en ráfagas estridentes"},
      { tiempo: 80, texto: "Pero detente a respirar y sabrás que son tuyos"},
      { tiempo: 85, texto: "Oscilando como una puerta abierta cuando llegan las tormentas" },
      { tiempo: 90, texto: "Resiste", sound:   { type: 'beep', freq: 400, duration: 180 } },
      { tiempo: 95, texto: "El tiempo es un asalto, el amor es una misión"},
      { tiempo: 100, texto: "Trabajamos en vocaciones hasta que, en remisión,"},
      { tiempo: 105, texto: "Deseamos haber tenido paciencia y dado más tiempo a nuestros hijos", sound:  { type: 'beep', freq: 400, duration: 180 } },
      { tiempo: 110, texto: "Siente cada decisión que tomes"},
      { tiempo: 115, texto: "Tómala, sostenla"},
      { tiempo: 120, texto: "Mantente firme", sound:  { type: 'beep', freq: 400, duration: 180 } },
      { tiempo: 125, texto: "Abraza a tus amantes"},
      { tiempo: 130, texto: "Toma sus manos"},
      { tiempo: 135, texto: "Sostén sus pechos en tus manos como si fueran su sostén"},
      { tiempo: 140, texto: "Sostén su rostro en tus palmas como una oración" },
      { tiempo: 145, texto: "Abrázalos toda la noche, siente que te devuelven el abrazo" },
      { tiempo: 150, texto: "No te contengas"},
      { tiempo: 155, texto: "Mantente firme", sound: { type: 'beep', freq: 400, duration: 180 } },
      { tiempo: 160, texto: "Cada dolor" },
      { tiempo: 165, texto: "Cada agravio" },
      { tiempo: 170, texto: "Cada puñalada de vergüenza" },
      { tiempo: 175, texto: "Cada día pasado con un demonio en tu mente persiguiéndote" },
      { tiempo: 180, texto: "Sosténlo" },
      { tiempo: 185, texto: "Conoce a los lobos que te cazan" },
      { tiempo: 190, texto: "Con el tiempo, serán los perros que traigan tus zapatillas" },
      { tiempo: 195, texto: "Ámalos bien y sentirás que te besan cuando vengan a morder" },
      { tiempo: 200, texto: "Hocicos calientes desenterrando tus mimos con sus hocicos ensangrentados" },
      { tiempo: 205, texto: "Resiste", sound:  { type: 'beep', freq: 400, duration: 180 } },
      { tiempo: 210, texto: "Nada que compres te hará más completo" },
      { tiempo: 215, texto: "Todo esto se alimenta de que nos sintamos siempre incompletos" },
      { tiempo: 220, texto: "Y por eso buscamos la felicidad en lo que sea que anhelamos en el momento" },
      { tiempo: 225, texto: "Y por eso nunca podemos encontrarla realmente allí" },
      { tiempo: 230, texto: "Por eso te sientas con el amante por el que luchaste" },
      { tiempo: 235, texto: "En el coche que sudaste años para comprar" },
      { tiempo: 240, texto: "Llevando el anillo con el que soñaste toda tu vida" },
      { tiempo: 245, texto: "Y aún así, alguna parte de ti no estará segura de que estos es lo que realmente quieres" },
      { tiempo: 250, texto: "Deja de ansiar" },
      { tiempo: 255, texto: "Mantente firme", sound:  { type: 'beep', freq: 400, duration: 180 } },
      { tiempo: 260, texto: "Pero si estás satisfecho con dónde estás, con quién eres" },
      { tiempo: 265, texto: "No necesitarás comprar nuevo maquillaje o ropa nueva o nuevas ollas y sartenes" },
      { tiempo: 270, texto: "Para cocinar receras nuevas y emocionantes para gente nueva y emocionante" },
      { tiempo: 275, texto: "Para hacerte sentir como la persona nueva y emocionante que crees que deberías ser" },
      { tiempo: 280, texto: "La felicidad, la marca, no es felicidad" },
      { tiempo: 285, texto: "Somos más inteligentes de lo que creen que somos" },
      { tiempo: 290, texto: "Nos toman a todos por idiotas, pero ese es su problema" },
      { tiempo: 300, texto: "Cuando actuamos como idiotas, se convierte en nuestro problema" },
      { tiempo: 305, texto: "Así que, mantente firme", sound:  { type: 'beep', freq: 400, duration: 180 } },
      { tiempo: 310, texto: "Respira hondo en una playa helada" },
      { tiempo: 315, texto: "Prueba la sal de la amistad", sound:  { type: 'beep', freq: 400, duration: 180 } },
      { tiempo: 320, texto: "Fíjate en el movimiento de un extraño" },
      { tiempo: 325, texto: "Mantente firme", sound:  { type: 'beep', freq: 400, duration: 180 } },
      { tiempo: 330, texto: "Y deja que sea" },
      { tiempo: 335, texto: "Contagioso", sound:  { type: 'beep', freq: 400, duration: 180 } }
    ];

    // === DOM ===
    const fraseDiv = document.getElementById('frase');
    const startBtn = document.getElementById('startBtn');

    // === CONTROL ===
    startBtn.addEventListener('click', () => {
      ensureAudioCtx(); // desbloquea audio en móviles
      startBtn.disabled = true;
      startBtn.textContent = "Experiencia en curso";

      fraseDiv.style.opacity = '0';

      setTimeout(() => {
        const startTime = Date.now();
        fraseDiv.textContent = "Preparados...";
        fraseDiv.style.opacity = '1';

        let i = 0;
        const lastTime = frases[frases.length - 1].tiempo;

        const interval = setInterval(() => {
          const elapsed = Math.floor((Date.now() - startTime) / 1000);

          while (i < frases.length && elapsed >= frases[i].tiempo) {
            const f = frases[i];

            // Transición visual
            fraseDiv.style.opacity = '0';
            setTimeout(() => {
              fraseDiv.textContent = f.texto;
              fraseDiv.style.opacity = '1';
            }, 800);

            // Sonido (acepta todos los tipos)
            if (f.sound) {
              // Alias 'beep' -> usa 'wave' si viene, por defecto 'sine'
              const declaredType = f.sound.type;
              const wave = f.sound.wave || declaredType;
              const type = declaredType === 'beep' ? (f.sound.wave || 'sine') : declaredType;

              if (type === 'noise') {
                playNoise(f.sound.duration ?? 200, f.sound.volume ?? 0.05);
              } else {
                playTone(f.sound.freq ?? 880, f.sound.duration ?? 200, type ?? 'sine', f.sound.volume ?? 0.06);
              }
            }

            i++;
          }

          // Fin
          if (elapsed > lastTime + 2) {
            clearInterval(interval);
            setTimeout(() => {
              fraseDiv.style.opacity = '0';
              setTimeout(() => {
                fraseDiv.textContent = "La experiencia ha concluido";
                fraseDiv.style.opacity = '1';
              }, 800);
            }, 1500);
          }
        }, 200);
      }, 1000);
    });
  </script>

</body>

</html>













